//Package Hotel adalah package dari class/form panel_check_out
package Hotel;

/*
Memasukkan fungsi error pada sql
Memasukkan fungsi tergenerated logging level untuk menentukan set standar dalam mengendalikan output logging utility
Memasukkan fungsi tergenerated logging logger untuk melakukan loging pesan log dari sistem atau komponen aplikasi hotel
Memasukkan fungsi swing panel pilihan pada gui
 */
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;

//@author ltf
//Deklarasi class atau form panel_check_out, yang berfungsi untuk check out dengan gui, class ini merupakan gui jframe maka menjadi turunan swing jframe
public class panel_check_out extends javax.swing.JFrame {

    /*
    Deklarasi constructor panel check out
    initComponent merupakan method yg saat membuat jframe tergenerate otomatis, karena fungsinya sebagai instalator komponen gui dan menghubungkan ke class
     */
    public panel_check_out() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor. Kode generated dari sistem dan tidak bisa
     * diedit
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        label_id_member = new javax.swing.JLabel();
        button_submit_member = new javax.swing.JButton();
        button_cancel_member = new javax.swing.JButton();
        textfield_id = new javax.swing.JTextField();
        background = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(new java.awt.GridBagLayout());

        label_id_member.setText("Masukan Id ");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.ipadx = 52;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(150, 440, 0, 0);
        getContentPane().add(label_id_member, gridBagConstraints);

        button_submit_member.setText("Check Out");
        button_submit_member.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_submit_memberActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.ipadx = 7;
        gridBagConstraints.ipady = -3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(70, 0, 0, 0);
        getContentPane().add(button_submit_member, gridBagConstraints);

        button_cancel_member.setText("Cancel");
        button_cancel_member.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_cancel_memberActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.ipadx = 8;
        gridBagConstraints.ipady = -3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(70, 440, 0, 0);
        getContentPane().add(button_cancel_member, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.ipadx = 194;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(16, 440, 0, 0);
        getContentPane().add(textfield_id, gridBagConstraints);

        background.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Hotel/Untitled-4.jpg"))); // NOI18N
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.gridheight = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(11, 10, 0, 10);
        getContentPane().add(background, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    /*
    Deklarasi method button submit member untuk melakukan aksi tombol submit
    Coba 
    Deklarasi int id dengan nilai parsing ambilan nilai dari texfield id
    Coba
    Deklarasi Transaksi t instansiasi objek Transaksi baru
    Mengambil data id
    Jika kode transaksi t = 0 maka lakukan tampilkan pesan nullpointer error exception
    Jika total harga tidak samadengan 0 maka tampilkan Exception
    Variable t lakukan method checkOut()
    Deklarasi double hrg1, String hrg dan int ab dengan nilai 0
    Lakukan
    Deklarasi variable String show dengan nilai " "
    Variable show update nilai String berisi format perintah database untuk menampilkan total harga pembayaran
    Variable hrg menampilkan show
    Variable hrg1 update nilai parsing hrg ke double
    Variable hrg1 - total harga transaksi
    Update nilai variable ab = 1
    Jika hrg1 kurangdari 0 tampilkan "uang anda kurang"
    Update nilai ab = 0
    Lakukan selama ab = 0
    Deklarasi variable String data untuk menampilkan transaksi
    Menampilkan pesan transaksi
    Tampilkan pesan error sesuai dengan error yang terjadi
    */
    private void button_submit_memberActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_submit_memberActionPerformed
        try {
            int id = Integer.parseInt(textfield_id.getText());
            try {
                Transaksi t = new Transaksi();
                t.retrieveData(id);
                if (t.getKodeTransaksi() == 0) {
                    throw new NullPointerException();
                }
                if (t.getTotalHarga() != 0) {
                    throw new Exception();
                }
                t.CheckOut();
                double hrg1;
                String hrg;
                int ab = 0;
                do {
                    String show = "";
                    show = String.format("Total: %.0f\nPembayaran: ", t.getTotalHarga());
                    hrg = JOptionPane.showInputDialog(this, show);
                    hrg1 = Double.parseDouble(hrg);
                    hrg1 = hrg1 - t.getTotalHarga();
                    ab = 1;
                    if (hrg1 < 0) {
                        JOptionPane.showMessageDialog(this, "Uang anda kurang");
                        ab = 0;
                    }
                } while (ab == 0);
                String data = String.format("%s\nPembayaran %23s\nKembalian %27.0f", t.showDetail(), hrg, hrg1);
                JOptionPane.showMessageDialog(this, data);
                textfield_id.setText("");
            } catch (SQLException ex) {
                Logger.getLogger(panel_check_out.class.getName()).log(Level.SEVERE, null, ex);
            } catch (NullPointerException a) {
                JOptionPane.showMessageDialog(this, "ID tidak terdaftar");
            } catch (Exception a) {
                JOptionPane.showMessageDialog(this, "Sudah Checkout");
            }
        } catch (NumberFormatException a) {
            JOptionPane.showMessageDialog(this, "Invalid Input");
        }
    }//GEN-LAST:event_button_submit_memberActionPerformed

    //Deklarasi method button cancel dan tidak menampilkannya
    private void button_cancel_memberActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_cancel_memberActionPerformed
        this.setVisible(false);
    }//GEN-LAST:event_button_cancel_memberActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(panel_check_out.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(panel_check_out.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(panel_check_out.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(panel_check_out.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new panel_check_out().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel background;
    private javax.swing.JButton button_cancel_member;
    private javax.swing.JButton button_submit_member;
    private javax.swing.JLabel label_id_member;
    private javax.swing.JTextField textfield_id;
    // End of variables declaration//GEN-END:variables
}
